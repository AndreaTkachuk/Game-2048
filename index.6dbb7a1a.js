const e=new class{constructor(e){console.log(e)}moveLeft(){}moveRight(){}moveUp(){}moveDown(){}getScore(){}getState(){}getStatus(){}start(){}restart(){}},t=document.querySelector(".button"),l=document.querySelector(".message-start"),n=document.querySelector(".message-win"),o=document.querySelector(".message-lose"),r=document.querySelector(".game-score"),s=document.querySelectorAll(".field-cell");let c="idle",u=0;const d=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];let a=[];t.addEventListener("click",l=>{t.classList.contains("start")?e.start():e.restart()}),e.getScore=()=>r.textContent,e.getState=()=>a,e.getStatus=()=>c,e.start=function(){t.classList.replace("start","restart"),t.textContent="Restart",l.className.includes("hidden")||l.classList.add("hidden"),n.className.includes("hidden")||n.classList.add("hidden"),o.className.includes("hidden")||o.classList.add("hidden"),c="playing",a=structuredClone(d),r.textContent=0;for(let e=0;e<2;e++)h(a[Math.floor(4*Math.random())]);v()},e.restart=()=>{t.classList.replace("restart","start"),t.textContent="Start",l.classList.remove("hidden"),n.className.includes("hidden")||n.classList.add("hidden"),o.className.includes("hidden")||o.classList.add("hidden"),r.textContent=0,c="idle",a=structuredClone(d),v()},e.moveLeft=function(){let e=structuredClone(a);a.forEach(e=>m(e)),L(e,a)||p(a),e=null,r.textContent=u,v()},e.moveRight=function(){let e=structuredClone(a);a.forEach(e=>g(e)),L(e,a)||p(a),e=null,r.textContent=u,v()},e.moveUp=function(){let e=function(e){let t=[],l=[];for(let l=0;l<4;l++){let n=[];for(let t=0;t<4;t++)n.push(e[t][l]);t.push(n)}t.forEach(e=>m(e));for(let e=0;e<4;e++){let n=[];for(let l=0;l<4;l++)n.push(t[l][e]);l.push(n)}return l}(a),t=structuredClone(a);a=structuredClone(e),e=null,L(t,a)||p(a),t=null,r.textContent=u,v()},e.moveDown=function(){let e=function(e){let t=[],l=[];for(let l=0;l<4;l++){let n=[];for(let t=0;t<4;t++)n.push(e[t][l]);t.push(n)}t.forEach(e=>g(e));for(let e=0;e<4;e++){let n=[];for(let l=0;l<4;l++)n.push(t[l][e]);l.push(n)}return l}(a),t=structuredClone(a);a=structuredClone(e),e=null,L(t,a)||p(a),t=null,r.textContent=u,v()},document.addEventListener("keydown",t=>{"ArrowLeft"===t.key&&e.moveLeft(),"ArrowRight"===t.key&&e.moveRight(),"ArrowUp"===t.key&&e.moveUp(),"ArrowDown"===t.key&&e.moveDown()}),document.addEventListener("touchstart",function(e){let t=e.touches[0];i=t.clientX,f=t.clientY}),document.addEventListener("touchmove",function(t){if(!i||!f)return;let l=t.touches[0].clientX,n=t.touches[0].clientY,o=i-l,r=f-n;o**2>r**2?o>0?e.moveLeft():e.moveRight():r>0?e.moveUp():e.moveDown(),i=null,f=null});let i=null,f=null;function h(e){if(!e.includes(0))return"message-lose";{let t=e.map((e,t)=>0===e?t:null).filter(e=>null!==e);e[t[Math.floor(Math.random()*t.length)]]=.1>=Math.random()?4:2}}function m(e){for(let t=e.length-2;t>=0;t--)0===e[t]&&0!==e[t+1]&&([e[t],e[t+1]]=[e[t+1],e[t]]),0!==e[t]&&e[t+1]===e[t]&&0===e[t-1]&&([e[t-1],e[t+1]]=[e[t+1],e[t-1]]);for(let t=0;t<e.length-1;t++)0===e[t]&&t+2<e.length&&([e[t],e[t+1],e[t+2]]=[e[t+1],e[t+2],0]),0!==e[t]&&e[t+1]===e[t]&&([e[t],e[t+1]]=[e[t+1]+e[t],0],u+=e[t]);for(let t=e.length-2;t>=0;t--)0===e[t]&&0!==e[t+1]&&([e[t],e[t+1]]=[e[t+1],e[t]]),0!==e[t]&&e[t+1]===e[t]&&0===e[t-1]&&([e[t-1],e[t+1]]=[e[t+1],e[t-1]]);return e}function g(e){for(let t=1;t<e.length;t++)0===e[t]&&0!==e[t-1]&&([e[t],e[t-1]]=[e[t-1],e[t]]),0!==e[t]&&e[t-1]===e[t]&&0===e[t+1]&&([e[t+1],e[t-1]]=[e[t-1],e[t+1]]);for(let t=e.length-1;t>=0;t--)0===e[t]&&t-2>0&&([e[t],e[t-1],e[t-2]]=[e[t-1],e[t-2],0]),0!==e[t]&&e[t-1]===e[t]&&([e[t],e[t-1]]=[e[t-1]+e[t],0],u+=e[t]);for(let t=1;t<e.length;t++)0===e[t]&&0!==e[t-1]&&([e[t],e[t-1]]=[e[t-1],e[t]]),0!==e[t]&&e[t-1]===e[t]&&0===e[t+1]&&([e[t+1],e[t-1]]=[e[t-1],e[t+1]])}function v(){let e=[];s.forEach(e=>e.className="field-cell");for(let t=0;t<4;t++)for(let l=0;l<4;l++)e.push(a[t][l]);e.includes(2048)&&n.classList.remove("hidden");for(let t=0;t<e.length;t++)0!==e[t]&&(s[t].textContent=e[t]),0===e[t]&&(s[t].textContent="");s.forEach(e=>{e.textContent>0&&e.classList.add(`field-cell--${e.textContent}`)});let t=[],l=!1;for(let e=0;e<4;e++){let l=[];for(let t=0;t<4;t++)l.push(a[t][e]);t.push(l)}for(let e=0;e<4;e++){for(let t=0;t<3;t++)a[e].includes(0)||a[e][t]!==a[e][t+1]||(l=!0);a[e].includes(0)&&(l=!0)}for(let e=0;e<4;e++)for(let n=0;n<3;n++)t[e].includes(0)||t[e][n]!==t[e][n+1]||(l=!0);l||o.classList.remove("hidden")}function p(e){let t=[];for(let l=0;l<4;l++)for(let n=0;n<4;n++)t.push(e[l][n]);t.includes(0)?h(t):o.classList.remove("hidden");let l=0;for(let n=0;n<4;n++)for(let o=0;o<4;o++)e[n][o]=t[l],l++;return e}function L(e,t){let l=[],n=[];for(let o=0;o<e.length;o++)for(let r=0;r<e.length;r++)l.push(e[o][r]),n.push(t[o][r]);for(let e=0;e<l.length;e++)if(l[e]!==n[e])return!1;return!0}
//# sourceMappingURL=index.6dbb7a1a.js.map
